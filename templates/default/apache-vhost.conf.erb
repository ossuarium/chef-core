<VirtualHost *:<%= @server_port || node['apache']['listen_ports'].first %>>
  ServerAdmin <%= node['apache']['contact'] %>
  ServerName <%= @server_name %>

<% if @server_aliases -%>
  ServerAlias <%= [@server_aliases].flatten.join " " %>
<% end -%>

  DocumentRoot <%= @docroot %>

<% if @directory_index -%>
  DirectoryIndex <%= [@directory_index].flatten.join " " %>
<% end -%>

  <Directory <%= @docroot %>/>
    Options <%= [@directory_options || 'FollowSymLinks'].flatten.join " " %>
    AllowOverride <%= [@allow_override || 'None'].flatten.join " " %>
    Require all granted
  </Directory>

  LogLevel <%= @log_level || 'info' %>

  ErrorLog <%= node['apache']['log_dir'] %>/<%= @name %>-error.log
  CustomLog <%= node['apache']['log_dir'] %>/<%= @name %>-access.log vhost_combined

<% @includes.each do |inc| -%>
  Include <%= inc %>
<% end -%>
</VirtualHost>
